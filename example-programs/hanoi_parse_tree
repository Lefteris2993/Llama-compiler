StmtBlock(
    LetDef(
        DefBlock(
            ImmutableDef(
                main,
                LetInExpr(
                    LetDef(
                        DefBlock(
                            ImmutableDef(
                                move,
                                BinOp(
                                    16,
                                    BinOp(
                                        16,
                                        BinOp(
                                            16,
                                            BinOp(
                                                16,
                                                FunctionCall(
                                                    print_string,
                                                    ExprHighBlock(
                                                        ExprHigh("Moving from: ")
                                                    )
                                                ),
                                                FunctionCall(
                                                    print_string,
                                                    ExprHighBlock(
                                                        IdHighPrioExpr(source)
                                                    )
                                                )
                                            ),
                                            FunctionCall(
                                                print_string,
                                                ExprHighBlock(
                                                    ExprHigh(" to ")
                                                )
                                            )
                                        ),
                                        FunctionCall(
                                            print_string,
                                            ExprHighBlock(
                                                IdHighPrioExpr(target)
                                            )
                                        )
                                    ),
                                    FunctionCall(
                                        print_string,
                                        ExprHighBlock(
                                            ExprHigh("\n")
                                        )
                                    )
                                ),
                                ParBlock(
                                    Par(source),
                                    Par(target)
                                )
                            )
                        )
                    ),
                    LetInExpr(
                        LetDefRec(
                            DefBlock(
                                ImmutableDef(
                                    hanoi,
                                    IfThenElse(
                                        BinOp(
                                            8,
                                            IdHighPrioExpr(rings),
                                            DeRefHighPrioExpr(0)
                                        ),
                                        BinOp(
                                            16,
                                            BinOp(
                                                16,
                                                FunctionCall(
                                                    hanoi,
                                                    ExprHighBlock(
                                                        BinOp(
                                                            1,
                                                            IdHighPrioExpr(rings),
                                                            DeRefHighPrioExpr(1)
                                                        ),
                                                        IdHighPrioExpr(source),
                                                        IdHighPrioExpr(auxil),
                                                        IdHighPrioExpr(target)
                                                    )
                                                ),
                                                FunctionCall(
                                                    move,
                                                    ExprHighBlock(
                                                        IdHighPrioExpr(source),
                                                        IdHighPrioExpr(target)
                                                    )
                                                )
                                            ),
                                            FunctionCall(
                                                hanoi,
                                                ExprHighBlock(
                                                    BinOp(
                                                        1,
                                                        IdHighPrioExpr(rings),
                                                        DeRefHighPrioExpr(1)
                                                    ),
                                                    IdHighPrioExpr(auxil),
                                                    IdHighPrioExpr(target),
                                                    IdHighPrioExpr(source)
                                                )
                                            )
                                        )
                                    ),
                                    ParBlock(
                                        Par(rings),
                                        Par(source),
                                        Par(target),
                                        Par(auxil)
                                    )
                                )
                            )
                        ),
                        BinOp(
                            16,
                            FunctionCall(
                                print_string,
                                ExprHighBlock(
                                    ExprHigh("Please, give the number of rings: ")
                                )
                            ),
                            LetInExpr(
                                LetDef(
                                    DefBlock(
                                        ImmutableDef(
                                            n,
                                            FunctionCall(
                                                read_int,
                                                ExprHighBlock(
                                                    UnitHighPrioExpr( unit )
                                                )
                                            ),
                                            ParBlock()
                                        )
                                    )
                                ),
                                FunctionCall(
                                    hanoi,
                                    ExprHighBlock(
                                        IdHighPrioExpr(n),
                                        ExprHigh("left"),
                                        ExprHigh("right"),
                                        ExprHigh("middle")
                                    )
                                )
                            )
                        )
                    )
                ),
                ParBlock()
            )
        )
    )
)
